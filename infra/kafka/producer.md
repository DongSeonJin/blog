---
description: 카프카 프로듀서
---

# Producer



## 카프카에 메시지를 쓰는 과정

카프카에 메시지를 쓰는 작업은 ProducerRecord 객체를 생성함으로써 시작된다.

'토픽'과 '밸류' 지정은 필수, '키'와 '파티션' 지정은 선택사항

### 1. 시리얼라이저

* 메시지의 키와 값을 네트워크로 보낼 수 있도록 바이트 배열로 변환한다.

### 2. 파티셔너

* 메시지 키의 해시값 등을 이용해 어떤 파티션으로 보낼지 결정한다.

### 3. 레코드 배치

* 파티션이 결정되면 메시지를 바로 보내지 않고, 레코드들을 모은 레코드 배치에 추가 한다.

### 4. 전송

* 별도의 스레드가 배치로 묶인 메시지를 브로커로 전송한다.

### 5. 실패 및 재시도

* 전송이 실패하면, 설정된 횟수만큼 자동으로 재시도를 한다.

### 6. 브로커 저장 및 응답

* 전송에 성공하면 브로커는 해당 토픽의 파티션에 메시지를 저장하고, 성공했다는 응답을 프로듀서에게 보낸다.





